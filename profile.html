<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ü—Ä–æ—Ñ–∏–ª—å</title>
<style>
  body {background:#121212;color:#fff;font-family:Arial;text-align:center;}
  .box {margin:120px auto;width:420px;padding:25px;background:#1e1e1e;border-radius:12px;}
  button{
    padding:10px 20px;
    margin:10px;
    background:#6A5ACD;
    color:white;
    border:none;
    border-radius:6px;
    cursor:pointer;
  }
  .disabled{background:#555;cursor:not-allowed;}
</style>
</head>
<body>
  <div class="box">
    <h2>üë§ –ü—Ä–æ—Ñ–∏–ª—å</h2>
    <p><b>–ù–∏–∫:</b> <span id="username"></span></p>
    <p><b>–ü–æ–¥–ø–∏—Å–∫–∞:</b> <span id="sub"></span></p>
    <p><b>–ü–∞–º—è—Ç—å:</b> <span id="mem"></span></p>
    <p><b>ID:</b> <span id="ident"></span></p>
    <p><b>–°–∫–∞—á–∏–≤–∞–Ω–∏–µ:</b> <span id="can"></span></p>

    <button id="downloadBtn" onclick="downloadFile()">‚¨á –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª</button>
    <button onclick="logout()">–í—ã–π—Ç–∏</button>
  </div>

<script>
  const user = JSON.parse(localStorage.getItem("currentUser")||"{}");
  if(!user.login){ window.location="index.html"; }

  // –≤—ã–≤–æ–¥–∏–º –¥–∞–Ω–Ω—ã–µ
  document.getElementById("username").innerText=user.username||"-";
  document.getElementById("sub").innerText=user.sub||"‚õî –Ω–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∏";
  document.getElementById("mem").innerText=user.mem||"-";
  document.getElementById("ident").innerText=user.ident||"-";
  document.getElementById("can").innerText=user.can_download?"‚úÖ –î–∞":"‚ùå –ù–µ—Ç";

  const btn = document.getElementById("downloadBtn");

  // –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∫–∏
  let canDownload = false;
  if(user.sub && user.sub !== "-"){  
    try {
      const today = new Date();
      const subDate = new Date(user.sub); // —Ñ–æ—Ä–º–∞—Ç "2026-05-10"
      if(subDate >= today){ canDownload = true; }
    } catch(e){ }
  }

  if(!canDownload){
    btn.classList.add("disabled");
    btn.disabled = true;
    btn.innerText = "üö´ –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–µ –∞–∫—Ç–∏–≤–Ω–∞";
  }

  function downloadFile(){
    if(!canDownload) return;
    // ‚ö†Ô∏è —Ç—É—Ç –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ª—é–±–æ–π —Ñ–∞–π–ª, –Ω–∞–ø—Ä–∏–º–µ—Ä demo.bin
    const url = "https://speed.hetzner.de/1MB.bin";
    const a = document.createElement("a");
    a.href = url;
    a.download = "file.bin";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  }

  function logout(){
    localStorage.removeItem("currentUser");
    window.location="index.html";
  }
</script>
</body>
</html>
